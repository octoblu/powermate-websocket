branches:
  only:
  - "/^v[0-9]/"
env:
  global:
  - secure: EaDpDlFDCbmehXtk4j6Drg1JA38D7d05Dqp9Uq+aUUG/gb8XyHp6xJua8O374shWGCmETJe3YIxydxjQ9O2LBG6ZrdL3DZgid+DAUQnrfdIZ+26h2CVEi0VyhJwa50MMlgIlZIR6TXOtFIFEu+wdbiMmU2hn8xsievPsnVipAMOUruHcurx2fBUcuyNIWr0XHDbIwE7us1ZQLqmpdhXEeZhirb+9q/+CtVkA4fry2J2oaN9S59eUNGqiLiv4Ji+qLwuKSrEhvFxdnEU2gDh4vHcGlvrbEh0jpBPPwzIXGEQwWm5DnDa/BzFbeOh0IeWANRP8D7wCzhplNQKsVJk+ELsMgqGfDWfHOICqXV/wmIM18D4edpq58IOWtzACguOqOkyuSnwQE82nA4scXNk3hKsfEVqnI2HxZlPuxpLitUcrp1jx2eaNHq+veE0QwtSjJ+gcFCY8y4XrI1xNz+UBeqA95ZoLvQqfKMyBqxDIkQRWo6Y/olJZnE/nWvF1PxosdcqPBh0bWTVrd8d7t6iqQlVf0vPWwA0bDGHOhITxFLC7UOLATea/31C/BHSZqF+0YTKkeoxAlcMi+9Jsq+zOKgqjUgvPnc2OtndiZb7KQR/bGUbsDOG1+HrxOnIW2Q58Rpt7MDiCzaIZd7e6sEEs8J5TpJEWkk0VqJ69CAeQo3k=
  - secure: fF6X/KtJocwFzMmTgnTX58bWoog3uFIFACWxBKqXWYY+0CcJ2I9KIPDBYJr1N/mWUNbq+35GUy4+pCjq3VGXFfR9HZJAQAHgFKi3JVJ9SB4Mp3Npfrh7E3+vMRWFavxZmTmNiwb7YLaFltxOLT+W9TUNVLdmZo4HAlJCK12l1EqGRyajO89Pl9PyAL8NZ5jj2KSNmitWT6FKo5gIsOyQAugrJt8Zk4YQLBdCQjRm6DfFq0PoLaHgmbr6U0sdajD4zcb8rYyMl5Gz+4mjKwDNVUGYIA3NK/1BtYODBp+mIS1agoXXflLYl9UW8DqXva+pZiKEh+Oa3csfMQ61Zhts07XEm677bmGHQ734b4usKW0MXUHKyCX/CzgG2OXxOxfcup7YlrodqAynJShEdIwzk3dK95Ng/wcUANa4NM0dwnIiSUETcDwOM2p07lAhKp2XI7rlndEXBaz8sMe/aNhsNuUAzNyTWb4VX0acsVR2KrouOb20aKJhCmwt3Y8aZSxNibZZc0OLF7LyFNOEad/GQQnOjS3uagOL5nz8yGnA/2yOv5H5Fqh++tkNYlhI7gAT+Tj2PcvcVBqVTn5NWAXBgtJB2GDdpL80y4JEg0QgvtISRrDbyj3vzi35cEXPBJQ5jcpSBYmubNXV0FxHkbjyatM/rzq1TsROEJaT7ALhrME=
  - secure: C4WzdoXcDsgZuO3f/y7F5yx2thk/xdquRHrdb/SK5Zjylh+VneoDjh5P4mALsS3NL2tuLTLfljDPD1LccQzYmIpRCCp5L4zniZRPyPYMe0c20tr4G/o8kM49t/SiragmqVNtUPLLJtlaUyyXPOd9dXy2ZsH5Cu9Gv973PtzhWPtkXCWnppNFx+p31ec/ssWJH10HjJonT0XLogQnJOLHZsi5Iuk1emCB1Z1NPj6v8qxx/5WTYwZOrtALfjm5uJQ5QPcM+SoQEpmwrGvgQexOMVbQvn8BRbv0ljrD/DA9kNzu1rXu6g9HgDuuFC1xsmpQkTqL9u3ERldSY6hXfj/b1MgCB2ucIVaWTgtucEjldYGVjLqzJm+NTpuuLa+DHM9Fw01+kiqa3R4HalIZZy9dTkapveTIch2RxMiTq5/kSRRkM/9R+Zi17AnlrUMjBGrMcB8UxfBYzzoWCag8caIT+I+H0o3mIsaGkKD4u5cNGQbxfbNsPJ8Ki95AOos8+Iq74+bay5B5cVpHeJu7mp1aPBw6UT9wU0Sa7RNx5b5YIzHiSCk6Dx+0UQl7qmnUfsCeL71Z/+W8tgsrMcMbZKEG9eGGMtx7xnhpeS6ixUcqwwq01iVC2kWZI0rJu34MRKk6XKBmGOmgBXLXbIcnK7V9zEeZVydi7y00468cnadi72g=
  - secure: D8SNx0A7wwmLBEV05nenBnSoSknxStlrb17eFK6s0mAT18kKZOIzfryjeAueaMIwItHr/TQxsd+5SCYGKfIL7QtvF7QTAenwat7tfBDNWEZWm6iUfAuIldG40VptiqvcZ5OmcWrLjSSV9hVS1PT0IWH0fzZ/lTXO13Z9xFx9ozfjm6zEjhL5hB/Mo59vEd1S+Bs6KO+ebJZMqRfEDxPaFytBBv39zcglMQARN6li1LXbFLpT0Q5u2pW+kUWQOlgWU42ynJ3fnU8r3F8Ldf01SPbJwkG/1tBQluXERhdC5AYqXI2b2K05sKvWaRR2p5F9fPqikdEOLx/7CabXqlCCsNe9djGiUMCuXnY17vm06iFOeYguXxh+jmVWk+B19vrWfgJM9s1ZRJr6ONKC6pJnt8OpaS/WC2hezpa1TZR8u/expIsMp9/NEIFqdAQLrVjTuIycOvmerERs997H9d1O7htUiY4H6K7BsUrvWwHj6ctc9zwPSKCb0VvuQQvg/4tnyfudyjb+r45jxvbc98FUkGPT16GqQYVtwjmzHAZ+AdczTUHlE/kXD0FnfD7h1UenohTsYxPG6ipZWg7Rg1nF8mHViNvLGyfmBUEDQ/klzFJUGWtcGzV8eFakKNL1PWOXBN/mbEfj5MMtaWl6Bm6FZGPWROM8CJZoBtpYO5vq+IA=
  - secure: cmUul7E5cxKBvn/B+1V/SGUntHXwV30mbSOpFm4g82Uh59bfo7t+VfF2nzppHh0o29dYnfFZ0WVWkla6Gc3TE19IipvPn1hsAFw7VGxxsVp+DMiHQN0w8s8+omzs7EybIByN5pEYx8YaZe2G5kkhlQe6P5OmzUaU8JpvD7bazF7+Lq9zXhUSoFz3sct/7ZAkWY6JNfF1/kHj2iYAlYczw5pCqjjuC5uykhoVQZBKyd5ASLmwvSUWM5tSDGscm2la2nrYN+wYoYP0ScAWIWKeQwa7un6Zhatr/yzXEM+DjbTdVjm5fYwx9L5gjuMfRkndXiEDK4miYI+o7RXysDiVSybQ06CfJ7WnAzQBsAfdhUqbbLvZW+0p9tloOuHypoXSUnOTfIMAFy7b2gEmofwAE5NghBxHXmMGoS2NVGQhXhWFwNBbx2PAjMl80KNqt/d6UqlCK/oCl85DyAiq14KPq81NTFmwjHuRB2+51jhAfTGu+66K7hto0xaeZyoa6Gsw0aKgrEfauqrzP5DyyKWQH724yCdNYaBADFM8lY4e1li5K/jQJ4nTLZD6rwG7MqX0rv8yHpLEWoWHGZXev+yGLB0dYNoLxBCoueojnkTPefCWZc4VJC88sgsOz4XiUx9uF2ZdIqAcrJaz7zniyQXK/RdtJzyXeK+1GqfUt2cwRvY=
  - secure: IHCqlc+njoYH50Xxdj53/JGo8dKxP5hOKAj5ShuY1GLjCSqD2c84mudF9ymag5iDzN8HzvSdt58pykyRgmhgFrS8E+g7iMqoIyEgn4LJAhsyPpkp/X9AmXbietYJtAppppqyEA1NHA3k5pphYt9Q5hBJEDUfoabeyW4K+mJ+nXvEnMGLnIQXZ+mIaA9XXXrwlPNL/oAYMkATWoP6m2SM8AaeQ/Uwy0EZsT+qmyHErGpApN5PW4+EyAFs5AVkp6zQCFq5NdBn/O1TW7nUrP+HaXwxiiZU8kxPJlj9Oz+ZvCqJyW+08TPRWG+SkXtkxT0dLzUHatBnLTjYfRcUoh2gG9fMnP0pWfgY3EQ5FUMioa82mrQ1vfwu8wWRifVnp6mxu9EGLYkwL023AXfROt1GX/LyiShtzhDTOoE06ekS588glFd7ubLn0mAUu+j6MPYlQxdBBw6M1z4vkHTgviTxl9nwwhCYaEi9NOlVBfz3ixUCl05hcUaCPOr1qrATpf/2XYxFGRhSpNt6FD0YairQHXNG6QSYqEcP2IcdBAWYEm6IQ/CnxZQ6+SdO7CETyFVN/H+gpUkVZAsZsZx5y63/LVyYPTiJYJYgXf37h023j108KDIasv0ezTQNIvKS6nOUU/ncJgS82v3lODcdd1FsF8zhbv9rfa7mrAope70EcY0=
  - secure: N2NQmqSp6PTZTI9se3dxTcTE0hmJpz7P92p6Sg0ixfByLT4JSvYneiWTSRFnoS+S+HYtKMt1U5YC+PN2a0icg0oo0D6WSwIs7Vv8rhkBfLsVKxa9OWrocL8eccS4CxnIXnbEpSIP18pg/4UOMN2kWRvqArvDzteFP1ih2tJKdOX+BFJaX+F7r1iZVftVOtSYS1qJHDcsl7LDOEx2nkgnfoBbtDoh1qL8E3pYxZi3ZeFHI0DZHUVvqILYOvcPL/90NEnfLDBPYoMazYwZagNjxDIlUSQunofB6Cms69fo6hd8Nt/E1NbCW5ciHn/YTw1N9KbHBvFjfc/6vDQZpGc2aKsQGtNgbjKXBHdIDVXAkvRf8ImSCf5olEUuPhzQUOgdY/TrdbTW1EDfJ+77HSSapO0gj+zH/3XJiSpUNYNwALErfkVa0IUIpmoeqQs3/3L44O2stvvXRApUyLpsliaqFbNhopTwkHe4lEBsMpWzIP/tmI7e4tkiHl6vPKHDqoxuCWVvVdC8+gpb0+nwLj7eUDR5EHNNiHmPFWE+NZvJw67Cz/jT74TOgNzS3ymKTCXrUMPHllIyDTUiEnV+mrwa5SI/JZRiichrFuqEaEmUjtbMyQAksEQ6vmKaMZS+Qtinpgsha4C6c+efkkJ5TeVe3JHiD9nF2r0GNBm1cBP8DZU=
  - secure: PAoQFesCYaDIOt0tGUTteeTgRZBqo1Nf5ikG59CJyxKuINu9C8Uuk/XY43E9oFFWL3Cq13V3Dce0Y1fqPYK0KqPl7QUuuu4+X7zU/s4ujd1R+AZXCCoRMS6U41/TOdKq3eB0fvng8Px3lSXHC3h+QxYLIXb9yoTIR4OuggY1CNw0HqGYF/1yZ6UsuufELJ4KDE9R4QgBcePfOhdAz2mepK2710o02XfNd8gWe+xCoPz1TGpNS3QTYYe/DYdtT5mSm59MgpbmoG3dnCeczcwxiJcR8l/PFGIGPjM+u/gpnMyg3biUGQkA3oUMjwKx1RLA6gRDfuboPcF7SUBMz4F9hF79LUG/eKYyb1ajYqaWrl6xp8c8uZuPVZq0HXEiJxZVDu+18jhO4+snTI3R4Llge7cNuDsBeUlCYrkeAy1lbSGSVlV6GppTDesVaU8FEX7c/y4M6YRKy4sWfXG+ETkWEuH5zKxdDCtgINfFZrUh2+Sl44dfVj+YchnMuL3y0+coQutFEuUWZobzi1Xs4JigOqz31lYLjor6ZsxxDoqVqHJm/1W1EV4EzA5KizyXYr1QIa1FFkQhhDTSsolWrmJMTVlJTE/BBOwpsPhQ1hlhI6IufLXpdHX0ygDFmfLVBDM5Hz5wq8ryhdwTd7t0Wg+XTVZ/yg1i91KBcvj3XWtQ28g=
os: linux
dist: trusty
language: shell
sudo: required
services:
- docker
install:
- docker pull octoblu/meshblu-connector-builder:linux-armv7
script:
- |
  docker run --rm --volume $PWD:/work \
    --env TRAVIS_REPO_SLUG=$TRAVIS_REPO_SLUG \
    --env TRAVIS_BRANCH=$TRAVIS_BRANCH \
    --env MESHBLU_CONNECTOR_UPLOADER_GITHUB_TOKEN=$MESHBLU_CONNECTOR_UPLOADER_GITHUB_TOKEN \
    --env AWS_REGION=$AWS_REGION \
    --env AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY \
    --env AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID \
    --env MESHBLU_CONNECTOR_ENCRYPTION_PASSWORD=$MESHBLU_CONNECTOR_ENCRYPTION_PASSWORD \
    --env MESHBLU_CONNECTOR_CERT_PASSWORD=$MESHBLU_CONNECTOR_CERT_PASSWORD \
    octoblu/meshblu-connector-builder:linux-armv7 \
      bash -c 'export HOME=/tmp/cache \
        && meshblu-connector-pkger \
        && meshblu-connector-installer-debian --destination-path=/usr/local/bin \
        && meshblu-connector-uploader-github \
        && upload-deb-s3 \
      '
