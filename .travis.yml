branches:
  only:
  - "/^v[0-9]/"
env:
  global:
  - secure: HRAAKA9+ddG5FNr0Gxru02jtAU4oLFQNjqpcpyXRitMAVrn9CY6JxDUMOYVL824vShFac6Vil5dNKNNAWCqqKsAjCW5TrNltCJx5bnneZ9d8CgbqQwGUlbdyF/kTe0nfbJiJBSnOV7mjymsouYpx+jCPO4vvklodqMlkcr2qbY1x2j58fACyLqa+JiDEikQtmN3SLFTBzCdFepursSX1aXosw8n+X4qzEJH20iN64tlQFf921GbgxHHjtfYoiIMqYuc/9t0EfVbGa5qEOeA0lKj5CjQjv0RbrwS3+msswS6pdAdMpZIcWS4mgWef9rY4DUc+Lmzq8pCWnz3aZ91vaELaoROjADGxCOPt5uCBfa1zIkl76S6KICVVSZkRyte88mHz8zZHosOgQXZolenRyfDrP+FnBAsdfyMVNy12ux0vu+PNUYGyYxU4GGRfPGJJe8NsfauRSRE3S9OC1lsC1w96U1nu//gZ2h4T8AUr7Nriauz7mNJWwCxHKsHC/4Qg2IEmGy8IduFcLBw0j2NKUbxIkMQsAy4zS7alGL2TWmaZZVdB5/ODP+9laJ1L2Wlm1Q144w80lNMBLqIk04fapvKyEdECOuD0BUpKt+4VIqfl3CBZriwso9OGzbuh2tU8MT9EbibZFVDxFbgqRomZiGn9NxP8/cjNeJMOXV0TSKk=
  - secure: El2k/T0PqJ1CFgdppKH3HP1AcrLnBF560LMagwpZ7H5L4YlXxO+janZUovXC9lo4LrHLbMKQi1zV/ig1A3IKisjXfkHL7oSyCHJNIK+l0WsCnYwVc8tCyC8eyfh/AEUougXSVxC/c/PH6bkSZbVN2W9yNULbuUVeJy4Br8O/ZGgwx6F81vKfHa7x+bRe9a0BHBD7VjTF6y+0dorEKMZ2EjhBefdVCHVZPPE2Lq1b/pAvrfOt6y02wcaqJuLpMmATtv1DtaLwhnsJctu6jAi95hNXGKp7MePs7jVgca+d822iSm/+ZsRENyfsaMxHZvo3OzJeWM/nMNVF4SU5OksLuWTZ2gV66071QDWHUQPW8e4GhBWp3HpL/QQopcvpW4m83J10kevu0A7FXy/01lxqCf2YPAUkagd/Rwn80+rPP2PLZxpgTNtaRANP4GvfvQ+52HhYuf3MZ2sxPqJfl8+EmoDdpliMoVzPtmUW1NtrWRVBwt1Dm2o4cl41tkJNSTZVpKPJq3tl5kQQJe7UMlVHlHgl5xXtIlIDJXvdv3ljM4kD03BlpwJX4gb3YUNvfSGpgb4xDXTMOw+UlnLZSbUAQdj9clidMasinMqSMjUgy98Vb9BIGcroonRneSWF1szm+QgEUNPk3P0U7tV4YVPVnZE3g1NeaNU2i+ml+C0GTMo=
  - secure: AoVLKS/Dvigob9YISOeL4jDl26vgMaMlt4ujdrb6aoKfFFbdyrnhhaPPEFsBIv89gFAgugYqST1ntt6CMXtSuiX7Bzly2wDP8IVgu13c3viF4EkJmmUZc7mASZhZfIuEzNjFwU3z5gVXIx1XdWaOguDDAh1R4xWH5i09em8S2FBju+yN7II6F5q7nIHzhBGuUWcw4xHmOYRye1XhsX/92DkbBSYMpHt0l0yCACOxeNacD/F8EiiuibGyQY2+1Ex/krpRwGYGPTd9RjxRBXPUb9pha1tOIp5BYpSOrYhYDyJmPT9syk1VzByslYlh30GuoT3XmzPvBMZfNHq+xrGLlFRMuRxDO4MV5qpxKdHk9Uq9W86iAEM19DRYHTyXZ9geCD+NQz1ADoKToOcL4rJB44uvO+Ec5RsdDzD7MxigcI+RYulAhfMWYgLUTiyd5atT754/RQHfC1WbxPe+QYg8spFJ4WF/vrxIfGeDn0drPvfWZDEDxzIXkZEkHoVfgnJsbZBwKZxR1pV3L6bVnx9ztA/N3zA1tiYNQdFD7pPYsJh5DLwVzoaAQsDz7I67ynzL4Xhd7JUyqHEkzAgvNtcGb6BScWMFMraIb4iPE57Wu3iyETLFSlcAB1oilPzBdnNFUX2dUCvkISCVDdLU3KCXF3OYnhvkVeYggPxd5c6a+OU=
  - secure: Y3Ip70YdyJbcMoAA7n9asmTNYmZoYDVR+pYbbgxjHVloq98CIZ66YJOUlu/PpUj7ikxbMj9L4xCmFb7KKtMVdp2wKPR7tG26IUmyE9DPMqJqaDhEuSPvNYxXbJjsk4ts3X1WuazoiFUZWcq/C67g61iXfixGmFBO8Bg7FiyPLyy/Ft9DOblBO2zT/pLl6QCEt+W4E3r/7Wjot8UAuboOQs8l24OCIiazrJCqxJdL3QpAmksg/4FCo1KaLT+ZwLoqjXNjBZLkHTNn5XydxDs/KrTGcrtl08XTQiXux/tqOWgplL3G3O2QQ+weIhtLAlwy3vBLMIEfT3uv8qD4iLVksQv5zHrkwvAgYHyhOHvqu8Towyif+y8xJ1mlbanLA0e1DHeOQ/j2/i5mc/IwLARFEb0tK+yCZ/+XNqweGkDaIGZbR3FdwoyZx7ZG/ZEUW9SjBNXtp6ASuyQ51d5joYQns+toUKkT6PowEwgs9wLJJAZq6yQOq+e8fnx9nNm9dByy9Zr7pD7pnCZPZCqm0FuCdY+W7QjnbDMLwZI/UdkLINiYCEmHxvLVOVZCd7/jT7Yt4/9geSrHJuvK7SxNQMJQzfmS4f0OeJgT49BXOBj2tzbQxWKCaAxhw3DXpwfpR2bLeuzW8Y7YnRip9bbgiQ3T4gJ00gcQtjfWoCotopYBXmQ=
  - secure: Kt0QqN/1LNQjzy/dzhthRMjNJRbhCp7KswYIRupF/+RqyUcZHvrc9Qg3c/ek9j42H54M7DIUknR20W91s3FSkEUCi6mOZdygmWTfsTrvFCkU4fd1nehRlGPH+mtiFsi1MWygvCpEv6pvijV0oDYFMGzz1o9SRa6/5SBoCsA8FSDldf+7NT1XYOSBUpXD55ohJ8daqStlS+jEMnE/0F1pfQ7hISMIDhjnK1sERYwt3maFZZwLjndMSDNlLdOTo3B9r70MuU9Z6rg1gWz5RoiFugCurPmNWXFOhSnvjJepaoJsDVReKSdlqhb3/YH9GqMqQM0oLPAdnFOgMKDtHHStrSYCcVkUDdIX8OdsZEa3hRyKyIcvw2R1FGPMR83Uc5wI0eEkdsfnm73BUWJdZiZV4VuLbUH+ZiqdOQpept5O3+8dfzlZN5DqBdjmK3H6ZQpVD5eK995frcVUZoQH6La+5cdf+8fuLzCGZb9PS6j8DohDTpc+mVV9WQBuDC0vZZ7ZBpeZkfWJzST3rWE8J/ae3NQ1AwHNe95/r6IO/VWGHdwrK0GL0UMqC27PJC7nolCYNSJmqDtXq8d3mnpPZNlh36CxT1x5XtJ8YsNMPeoxJP5onwtZ6hxdbqUbgmmNXMurp6T7ieTTerHHOaYEiFCRlqfh6UCDE9R0VsXwDF+xbsI=
  - secure: Ks9+YSuxsUD3PFKYlbNYWGOpYUxMtskBvLzn1B3wXMbXGMQN6dJxYe1rp9uaSz5JTiu9o/B9g3ovTPuZg+wpfywL2n8J2/pSvNKLnOrR+8fVCK/UjM8pZdbhXQc2RJAjweQvormNjDt9Ir7ZcCiAG2xsLeBd9fm5NK1CRI9/l4BmKM7g3idLDGvDfuL6gW16na2udKodtjwt/E04p1mYkQ/hjti8NjnIGLtvwfqiYtPKj19S7SjSFV6weO8Lk0Rd77S6d/MZU+ozoN8wX/36a/jzXu9f47Of3C4nlbbkGhYnJB0dInmn9iGNrxIiwCnPGdrwk77nZ7d+Xt/+1rHGPxp3Kmj0XklGvNcXCnOt6vXKeamUKGM2oJUMTdqhUcnIG2X7vMQS1fM3Yp6p4MEs2J93A3XRmMQsTSxYZyhEon5ddrXJ8NAiEPu2brxVPB9SKtCf7J7/eFHV2Bd6uO9jUkpbjUSCVzwrRC+K6fHGccLgx/iqob6UnvfmofESTOGU6N8p70927x7lHUQ+tauvnciXaPk6JuHagOsv5ENgf8gVeSIwNIw7+s3x0LzHKfLwB2XXl4TxZcH7nqlibpGKZ2gXCPRGhVMrxgtRKJi4mspoarFW5PH5tvzMJoa0GXvseI9D2+ANgHzxznv3BRHZ9DNDepJ/CyVz8t8JLQhjNNg=
  - secure: pes1fwMnY8/NOx1rTSan7C4FWQD+UKtzHVkAt/SfuBDem1jpwACkMTWSYyVlsQ9U+vkljtKPflkaKd/a+ZF+k9s6TQm2aWW4p5l7BKDIWguLY2BKbKCcj3Gx6AZJwCU5X6y4MAi0QrQCzxtKWPbiiZXbI9Rz/lLt8FFp9trh0kT0XWmjdSK8yXHudzFuDfZsykA8rBT2UWy7i4cu/iLo38lO08irKBoecD+Ase+ME3iGGprWLEf5+77N4fLF9+4NCN2qp0PSeZjm/oA3hb199BQTASYds/x6jgPv0o1BQ7tOhcAdDijmY+9Ua90IoBkM4T4XA0lcLxa6KSLDxeptxTi9umA2zgNgdm4VoHvC5YxZlb+lYrHfsZuSg+3yb8KVNk/8mRxgA5jb2kJecQuFvyN4BzA44Sn1EnB5kIsqcS5ce/ve9qbbmy1E73zd/LJkjZpZYwwsRcsTUhu2O+bkrz37fMkU8/KcAtxANcB0+MOM/eJsyDMHzEGZokguGG5I/D+UtFh3tfrYDxEzfihZ3pGygLly1OIPH/uRcL3S60FFcV5nrzK3NkPvknKXm4lEHYPrWy67LT9uRCWVIbPxK+u2M9fb9U1Ls8g8J6MEH4v7VWJ5Oo1dPTuZFG5su6X6IwCNRMU0jio8KzUU+TMAaHN3Ppg4xRhleLDX75B1PMM=
  - secure: HworrftlyXzGr430k8AdYWUjByJKf9jBSqg/C+XbpMajuxLtwdP5X7PuhOvjeBjCOLX1Y67s84ziKwBn4tb7CecgfbR+X8/NZA3G2ow1u1lndQrtwJgUsq9zS/LfNgpcJO0iApRZsJ/GF7YxNd0qbB6jdgCP7jzqyJJUzilUh0z0MNlxyVZqpPbKZggYNXBInBhu70yetii2/8pKB4RT0kKfzrbhUpZLNXojv7cYZDiucIRDSjTpv+ypvX26+XMAJlRoKStxR8N8zxSuHIyO5B9IRfOemhjxXMOig9ljjSHYIxMosSq5sco2VyQEviRJxLE0ydOffRRTtSJzhm7aa/vOImTBmIiwgW0diIlngkiGY9OqCcRP2AhpmJFbvuANcaJt0ygOHVnHdzNU20pM8gZVIx1Jhei92Umjc6W8EwRj0GpJNmE1rMKa51wwapPBNWRj8pMu+d8Zv62uEQWe5fy7wDnZVuAWIOzeZylg1OI6Hmfbn61dgR9fDHOoWW+df6ZjjR7GpW26fOaSAYIQZ2f91AYi3zqzrqM1ac890euWx2+EPRJpRtM/JIuFfmf/LAoueXAk+goY6xSCXsPsFCdGTTPl0mySw3ItL+LEm4BOhzIKpAl9/cLGGw9dMEU6OtM2jhgdyJx5ahQUbVXlJ3IaAz9hcGvTzB5aWUnMWI4=
os: linux
dist: trusty
language: shell
sudo: required
services:
- docker
install:
- docker pull octoblu/meshblu-connector-builder:linux-armv7
script:
- |
  docker run --rm --volume $PWD:/work \
    --env TRAVIS_REPO_SLUG=$TRAVIS_REPO_SLUG \
    --env TRAVIS_BRANCH=$TRAVIS_BRANCH \
    --env MESHBLU_CONNECTOR_UPLOADER_GITHUB_TOKEN=$MESHBLU_CONNECTOR_UPLOADER_GITHUB_TOKEN \
    --env AWS_REGION=$AWS_REGION \
    --env AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY \
    --env AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID \
    --env MESHBLU_CONNECTOR_ENCRYPTION_PASSWORD=$MESHBLU_CONNECTOR_ENCRYPTION_PASSWORD \
    --env MESHBLU_CONNECTOR_CERT_PASSWORD=$MESHBLU_CONNECTOR_CERT_PASSWORD \
    octoblu/meshblu-connector-builder:linux-armv7 \
      bash -c 'export HOME=/tmp/cache \
        && meshblu-connector-pkger \
        && meshblu-connector-installer-debian --destination-path=/usr/local/bin \
        && meshblu-connector-uploader-github \
        && upload-deb-s3 \
      '
